import{u as I}from"./index-B19IAqrI.js";import"./index-D1ypBbsW.js";import{a as j,d as S,r as B,c as $,w as W,o as Q,E as T,Q as U,b as i,l as q,e as a,n as m,F as y,f as k,t as n,s as A,B as H,u as G,k as d,A as z,p as J,y as F}from"./index-D0FIH5Mc.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"size-full overflow-auto"},X={class:"scrollable-date-table__header-row"},Z={class:"py-2 min-[500px]:px-2"},ee=["data-date"],te=["onClick"],ae={key:0,class:"mb-2 text-right text-xs md:text-sm"},le={class:"w-full"},se=["data-date","data-start-time","data-end-time"],re=15,ie=j({name:"ScrollableDateTable",__name:"index",props:{startDate:{default:""},endDate:{default:""},timeSlotDateMap:{default:()=>({})},separator:{default:"~"},daysOfWeekStrArr:{default:()=>["週日","週一","週二","週三","週四","週五","週六"]},firstDayOfWeek:{default:()=>0},headerBorderColor:{default:"bg-[#FBAD1D]"},activeBgCellColor:{default:"bg-[#FBCE7A66]"},inActiveBgCellColor:{default:"bg-transparent"},dateFormat:{default:"YYYY-MM-DD"},maxTableHeight:{default:void 0},activeClickCell:{type:Boolean,default:!1},cellWrapperClass:{default:""}},emits:["click-cell"],setup(f,{emit:v}){const t=f,b=v,O=S().get("year"),l=B(null),s=B(null),u=B(""),{width:E}=I(),R=$(()=>t.daysOfWeekStrArr.slice(t.firstDayOfWeek).concat(t.daysOfWeekStrArr.slice(0,t.firstDayOfWeek))),Y=$(()=>N({startDate:t.startDate,endDate:t.endDate,timeSlotDateMap:t.timeSlotDateMap,firstDayOfWeek:t.firstDayOfWeek})),N=({startDate:r,endDate:g,timeSlotDateMap:c,firstDayOfWeek:x})=>{let e=S(r);const p=[];for(;e.isSameOrBefore(S(g));){const o=Array(7).fill(null);let _=(e.day()-x)%7;for(let C=_;C<7&&e.isSameOrBefore(g);C++){const M=e.format(t.dateFormat),D=c[M];o[C]={date:M,timeSlots:D,dayjsObj:e,isDisabled:!D||D.length===0||D.every(L=>L.isDisabled)},e=e.add(1,"day")}p.push(o)}return p},w=()=>{if(!l.value||!s.value)return;const r=s.value.offsetWidth;l.value.style.width=`${r-re}px`},h=()=>{if(!t.maxTableHeight||!s.value){u.value="";return}u.value=s.value.offsetHeight>t.maxTableHeight?`${t.maxTableHeight}px`:""},V=r=>{!r?.timeSlots?.length||!t.activeClickCell||r.isDisabled||b("click-cell",r)};return W(Y,()=>{T(()=>{h()})}),W(()=>t.maxTableHeight,()=>{T(()=>{h()})}),W(()=>E.value,r=>{r<768&&T(()=>{h()})}),Q(()=>{T(()=>{h()}),s.value&&l.value&&(w(),window.addEventListener("resize",w))}),U(()=>{window.removeEventListener("resize",w)}),(r,g)=>(d(),i("div",{class:"scrollable-date-table__wrapper w-full overflow-hidden rounded",style:q({height:u.value})},[a("div",P,[a("div",{ref_key:"headerBorderRef",ref:l,class:m(["scrollable-date-table__header-border sticky top-9 left-1.5 z-20 h-px w-full",[t.headerBorderColor]])},null,2),a("table",{ref_key:"scrollableDateTableRef",ref:s,class:"scrollable-date-table h-fit w-full table-fixed border-collapse"},[a("thead",null,[a("tr",X,[(d(!0),i(y,null,k(R.value,c=>(d(),i("th",{key:c,class:"scrollable-date-table__header-cell sticky top-0 bg-white text-center align-top break-all"},[a("div",Z,n(c),1)]))),128))])]),a("tbody",null,[(d(!0),i(y,null,k(Y.value,(c,x)=>(d(),i("tr",{key:x,class:"scrollable-date-table__row h-full"},[(d(!0),i(y,null,k(c,(e,p)=>(d(),i("td",{key:p,class:"scrollable-date-table__cell rounded align-top break-all","data-date":e?.date},[a("div",{class:m(["scrollable-date-table__div flex h-full min-h-9 flex-col items-center overflow-hidden p-1 text-center whitespace-normal",[t.activeClickCell?!e||e?.isDisabled?"cursor-not-allowed":"cursor-pointer":""]]),onClick:o=>V(e)},[a("div",{class:m(["size-full min-h-9 rounded p-0.5 break-all md:p-2 xl:p-4",[e?.timeSlots?.length>0?t.activeBgCellColor:`border border-dashed ${t.inActiveBgCellColor}`,t.cellWrapperClass]])},[e?.timeSlots?.length>0?(d(),i("div",ae,[H(r.$slots,"date",{date:e.date,currentYear:G(O),dayjsObj:e.dayjsObj},()=>[z(n(e.date),1)],!0)])):A("",!0),a("div",le,[e?.timeSlots?.length>0?(d(!0),i(y,{key:0},k(e.timeSlots,(o,_)=>(d(),i("div",{key:_,class:m(["w-full text-right text-xs md:text-sm",[_!==e.timeSlots.length-1?"mb-1":""]]),"data-date":`${e.dayjsObj.format(f.dateFormat)}`,"data-start-time":o.startTime,"data-end-time":o.endTime,style:{wordBreak:"break-word"}},[H(r.$slots,"timeSlot",{date:e?.date,dayjsObj:e.dayjsObj,startTime:o.startTime,endTime:o.endTime},()=>[z(n(o.startTime)+" "+n(f.separator)+" "+n(o.endTime),1)],!0)],10,se))),128)):A("",!0)])],2)],10,te)],8,ee))),128))]))),128))])],512)])],4))}}),de=K(ie,[["__scopeId","data-v-bf9c854b"]]),oe={class:"w-full p-2"},ne={class:"w-full"},ce={class:"hidden md:inline-block"},he=j({name:"DemoScrollableDateTable",__name:"ScrollableDateTable",setup(f){const v={"2024/11/08":[{startTime:"08:00",endTime:"08:30",isDisabled:!0},{startTime:"18:00",endTime:"19:00",isDisabled:!0}],"2024/11/14":[{startTime:"08:00",endTime:"08:30",isDisabled:!0},{startTime:"15:00",endTime:"16:00",isDisabled:!0},{startTime:"16:00",endTime:"16:30",isDisabled:!0},{startTime:"18:00",endTime:"19:00",isDisabled:!0}],"2025/01/17":[{startTime:"08:00",endTime:"08:30",isDisabled:!1},{startTime:"15:00",endTime:"16:00",isDisabled:!1},{startTime:"19:00",endTime:"20:00",isDisabled:!1}],"2025/01/22":[{startTime:"08:00",endTime:"08:30",isDisabled:!1},{startTime:"15:00",endTime:"16:00",isDisabled:!1},{startTime:"16:00",endTime:"16:30",isDisabled:!1}]},t=b=>{console.log(b)};return(b,O)=>(d(),i("div",oe,[J(de,{"start-date":"2024-11-08","end-date":"2025-01-24","time-slot-date-map":v,"first-day-of-week":0,"max-table-height":400,"date-format":"YYYY/MM/DD","active-click-cell":!0,onClickCell:t},{date:F(({dayjsObj:l,currentYear:s})=>[a("div",ne,[a("span",{class:m(["custom-full-date-year w-full md:w-auto",[l.get("year")===s?"hidden":"inline-block"]])},n(l.get("year")===s?"":l.format("YYYY")),3),a("span",{class:m(["hidden",[l.get("year")===s?"":"md:inline-block"]])},"/",2),a("span",null,n(l.format("MM/DD")),1)])]),timeSlot:F(({date:l,startTime:s,endTime:u})=>[a("span",ce,n(l==="2024/11/08"?"Hoo~":"")+" "+n(s)+" - "+n(u),1)]),_:1})]))}});export{he as default};
